'use client'

import Image from 'next/image'
import Link from 'next/link'
import { ArrowLeft, Linkedin, Twitter } from 'lucide-react'

export default function CDKVulnerabilityPost() {
  return (
    <main className="min-h-screen pt-48 pb-32">
      <article className="container max-w-3xl">
        {/* Back Link */}
        <Link 
          href="/research"
          className="inline-flex items-center gap-2 text-lg opacity-60 hover:opacity-100 transition-opacity duration-300 mb-16"
        >
          <ArrowLeft className="w-4 h-4" />
          Back to Research
        </Link>

        {/* Category & Title */}
        <div className="space-y-8 mb-16">
          <div className="space-y-4">
            <span className="text-sm opacity-60">Security Alert</span>
            <h1 className="text-5xl font-normal leading-tight">
              How a Deleted S3 Bucket Could Hand Over Your Entire AWS Account to Attackers
            </h1>
          </div>
        </div>

        {/* Hero Image */}
        <div className="relative aspect-[21/9] mb-16 overflow-hidden rounded-sm">
          <Image
            src="/research/cdk-s3-exploit.jpg"
            alt="AWS CDK Security Vulnerability"
            fill
            className="object-cover"
            priority
          />
        </div>

        {/* Author & Date */}
        <div className="flex items-center gap-4 mb-16 text-sm opacity-60">
          <span>Cipher Weekly Team</span>
          <span className="w-1 h-1 rounded-full bg-current" />
          <span>July 2, 2024</span>
        </div>

        {/* Content */}
        <div className="[&>*]:mb-8 space-y-8">
          {/* Introduction */}
          <div className="space-y-6">
            <p className="text-xl leading-relaxed opacity-80">
              A critical security vulnerability in AWS Cloud Development Kit (CDK) has been discovered that could allow attackers to gain full administrative access to targeted AWS accounts. The issue, uncovered in June 2024, affects users who manually deleted their CDK deployment artifact S3 buckets after initial setup and continued using older CDK versions.
            </p>
          </div>

          {/* Vulnerability Details */}
          <div className="space-y-6">
            <h2 className="text-3xl font-normal">The Vulnerability</h2>
            <p className="text-lg leading-relaxed opacity-80">
              The vulnerability stems from CDK's predictable naming pattern for its staging buckets, combined with the default administrative privileges granted to CDK's CloudFormation execution role. If a user deletes their CDK staging bucket and an attacker claims the same bucket name, they can inject malicious code into CloudFormation templates when the victim deploys new infrastructure.
            </p>
          </div>

          {/* Impact Assessment */}
          <div className="space-y-6">
            <h2 className="text-3xl font-normal">Impact and Scope</h2>
            <p className="text-lg leading-relaxed opacity-80">
              Research across 38,000 AWS accounts revealed that approximately 10% of CDK users were potentially vulnerable to this attack vector. Since these templates are executed with administrative privileges, attackers can create backdoor admin roles and effectively take over the entire account.
            </p>
          </div>

          {/* Mitigation Steps */}
          <div className="space-y-6">
            <h2 className="text-3xl font-normal">Mitigation and Patches</h2>
            <p className="text-lg leading-relaxed opacity-80">
              AWS has since patched the issue in CDK version v2.149.0 by ensuring assets are only uploaded to buckets within the user's own account. However, users of earlier versions must take action to protect themselves by either upgrading their CDK installation or modifying their IAM policies.
            </p>
          </div>

          {/* Key Takeaways */}
          <div className="space-y-6">
            <h2 className="text-3xl font-normal">Key Takeaways</h2>
            <ul className="space-y-3 list-disc pl-6 text-lg opacity-80">
              <li>Always treat AWS Account IDs as sensitive information</li>
              <li>Use IAM policy conditions to restrict resource access to specific AWS accounts</li>
              <li>Avoid predictable naming patterns for S3 buckets</li>
              <li>Regularly update CDK and other infrastructure tools to receive security patches</li>
            </ul>
          </div>

          {/* Conclusion */}
          <div className="space-y-6">
            <h2 className="text-3xl font-normal">Conclusion</h2>
            <p className="text-lg leading-relaxed opacity-80">
              This vulnerability brings attention to how seemingly innocuous actions like bucket cleanup can create serious security vulnerabilities in cloud infrastructure. For affected users, AWS has released patches and directly notified potentially impacted customers, emphasising the importance of proper security measures in infrastructure-as-code deployments.
            </p>
          </div>
        </div>

        {/* Share Links */}
        <div className="mt-32 pt-8 border-t border-current/10">
          <div className="flex items-center gap-4">
            <span className="text-sm opacity-60">Share this article</span>
            <Link 
              href={`https://twitter.com/intent/tweet?text=How a Deleted S3 Bucket Could Hand Over Your Entire AWS Account to Attackers&url=${encodeURIComponent('https://cipherprojects.com/research/cdk-vulnerability')}`}
              target="_blank"
              rel="noopener noreferrer"
              className="opacity-60 hover:opacity-100 transition-opacity"
            >
              <Twitter size={20} />
            </Link>
            <Link 
              href={`https://www.linkedin.com/shareArticle?mini=true&url=${encodeURIComponent('https://cipherprojects.com/research/cdk-vulnerability')}&title=How a Deleted S3 Bucket Could Hand Over Your Entire AWS Account to Attackers`}
              target="_blank"
              rel="noopener noreferrer"
              className="opacity-60 hover:opacity-100 transition-opacity"
            >
              <Linkedin size={20} />
            </Link>
          </div>
        </div>
      </article>
    </main>
  )
}